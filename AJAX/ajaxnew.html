<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>AJAX + JSON + LocalStore</title>

    <!-- Bootstrap -->
    <link href="../bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	
	<style>
		.me-header
		{
				margin-top:50px;
		}
	</style>
	
  </head>
  <body>
		
		
	
	
	
	<nav class="navbar navbar-default">
	  <div class="container me-header">
	  
		<div>
			<p>
				<input type="text"  id="num" >
				<select id="sel">
					<option value="posts" >posts</option>
					<option value="comments" >comments	</option>
				</select>
				<button onclick="go()" >go</button>
			</p>
		</div>
		
		
		
		<hr />
		
		<div class="row" id="myrow">
		
		</div>
	  </div>
	</nav>
	
	
   

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="../jquery-1.11.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../bootstrap/js/bootstrap.min.js"></script>
	
	<script>
		"use strict"
		
		var arr = new Array();
		
		if( typeof(window.localStorage.me) == "string")
		{
			arr=$.parseJSON('[' + window.localStorage.me+ ']');
			arr=arr[0];
			view();
		}
		
		
		var root = 'http://jsonplaceholder.typicode.com';
	
	
		function  getRes(id ,sel){
		
			$.ajax({
			 url: root + '/'+sel+'/'+id.toString(),
			 method: 'GET'
			}).then(function(data) {
				if(window.localStorage.sel!=sel)
				{
					console.log(window.localStorage.sel);
					arr = new Array(); 
				}
				window.localStorage.sel=sel;
				arr.push(data);
				window.localStorage.me=JSON.stringify(arr);
				
				view();
			});
		}
		
		function showMe(data) { 
			
			var res="";
			var w=(100/Object.keys(data).length);
			
			//console.log(Object.keys(data).length);
			
			var mdiv='<div style="width:'+w+'%; float:left;">';
			$.each(data, function(key ,value) {
						 res+=mdiv+key+" = "+value+"</div>";
						 
			});
			
			return res;
		}
		
		
		function view(){
			var body='';
			
				$.each(arr, function(key ,value){
						 body+=showMe(value);
				});
				
				$('#myrow').html(body);

		}
		
		function go()
		{
			//console.log($('#num').val());
			var id =$('#num').val();
			
			var sel=$('#sel option:selected').text();

			getRes(id,sel);
		}
		
		
			
	</script>
  </body>
</html>